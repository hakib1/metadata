[
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column Column 1 using expression grel:if(lastIndexOf(value, \",\") == value.length()-1, substring(value, 0, value.length()-1), value)",
    "engineConfig": {
      "mode": "row-based",
      "facets": []
    },
    "columnName": "Column 1",
    "expression": "grel:if(lastIndexOf(value, \",\") == value.length()-1, substring(value, 0, value.length()-1), value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column Column 1 using expression grel:if(lastIndexOf(value, \".\") == value.length()-1, substring(value, 0, value.length()-1), value)",
    "engineConfig": {
      "mode": "row-based",
      "facets": []
    },
    "columnName": "Column 1",
    "expression": "grel:if(lastIndexOf(value, \".\") == value.length()-1, substring(value, 0, value.length()-1), value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/column-addition",
    "description": "Create column Cor at index 1 based on column Column 1 using expression grel:value",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "Cor",
    "columnInsertIndex": 1,
    "baseColumnName": "Column 1",
    "expression": "grel:value",
    "onError": "set-to-blank"
  },
  {
    "op": "core/recon",
    "description": "Reconcile cells in column Column 1 to type /people/person",
    "columnName": "Column 1",
    "config": {
      "mode": "standard-service",
      "service": "http://refine.codefork.com/reconcile/viafproxy/LC",
      "identifierSpace": "http://rdf.freebase.com/ns/user/hangy/viaf",
      "schemaSpace": "http://rdf.freebase.com/ns/type.object.id",
      "type": {
        "id": "/people/person",
        "name": "Person"
      },
      "autoMatch": true,
      "columnDetails": []
    },
    "engineConfig": {
      "mode": "row-based",
      "facets": []
    }
  },
  {
    "op": "core/recon",
    "description": "Reconcile cells in column Cor to type /organization/organization",
    "columnName": "Cor",
    "config": {
      "mode": "standard-service",
      "service": "http://refine.codefork.com/reconcile/viafproxy/LC",
      "identifierSpace": "http://rdf.freebase.com/ns/user/hangy/viaf",
      "schemaSpace": "http://rdf.freebase.com/ns/type.object.id",
      "type": {
        "id": "/organization/organization",
        "name": "/organization/organization"
      },
      "autoMatch": true,
      "columnDetails": []
    },
    "engineConfig": {
      "mode": "row-based",
      "facets": []
    }
  },
  {
    "op": "core/column-addition",
    "description": "Create column score at index 1 based on column Column 1 using expression grel:forEach(cell.recon.candidates, v, if((v.score >= 0.8), v.score, '')).join(\";\")",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "score",
    "columnInsertIndex": 1,
    "baseColumnName": "Column 1",
    "expression": "grel:forEach(cell.recon.candidates, v, if((v.score >= 0.8), v.score, '')).join(\";\")",
    "onError": "set-to-blank"
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column score using expression grel:if(isNonBlank(value), value + \";\", value)",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "score",
    "expression": "grel:if(isNonBlank(value), value + \";\", value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column score using expression grel:with(split(value, \";\"), v, if(v[1]==\"\", toNumber(v[0]), max(toNumber(v[0]), toNumber(v[1]))))",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "score",
    "expression": "grel:with(split(value, \";\"), v, if(v[1]==\"\", toNumber(v[0]), max(toNumber(v[0]), toNumber(v[1]))))",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/column-addition",
    "description": "Create column LCP at index 1 based on column Column 1 using expression grel:with(forEach(cell.recon.candidates, v, if(v.score == cells[\"score\"].value, v.id, \"\")).join(\";\"), a, a.split(\";\")[0])",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "LCP",
    "columnInsertIndex": 1,
    "baseColumnName": "Column 1",
    "expression": "grel:with(forEach(cell.recon.candidates, v, if(v.score == cells[\"score\"].value, v.id, \"\")).join(\";\"), a, a.split(\";\")[0])",
    "onError": "set-to-blank"
  },
  {
    "op": "core/column-addition",
    "description": "Create column score-c at index 4 based on column Cor using expression grel:forEach(cell.recon.candidates, v, if((v.score >= 0.8), v.score, '')).join(\";\")",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "score-c",
    "columnInsertIndex": 4,
    "baseColumnName": "Cor",
    "expression": "grel:forEach(cell.recon.candidates, v, if((v.score >= 0.8), v.score, '')).join(\";\")",
    "onError": "set-to-blank"
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column score-c using expression grel:if(isNonBlank(value), value + \";\", value)",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "score-c",
    "expression": "grel:if(isNonBlank(value), value + \";\", value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column score-c using expression grel:with(split(value, \";\"), v, if(v[1]==\"\", toNumber(v[0]), max(toNumber(v[0]), toNumber(v[1]))))",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "score-c",
    "expression": "grel:with(split(value, \";\"), v, if(v[1]==\"\", toNumber(v[0]), max(toNumber(v[0]), toNumber(v[1]))))",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/column-addition",
    "description": "Create column LCC at index 4 based on column Cor using expression grel:with(forEach(cell.recon.candidates, v, if(v.score == cells[\"score-c\"].value, v.id, \"\")).join(\";\"), a, a.split(\";\")[0])",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "LCC",
    "columnInsertIndex": 4,
    "baseColumnName": "Cor",
    "expression": "grel:with(forEach(cell.recon.candidates, v, if(v.score == cells[\"score-c\"].value, v.id, \"\")).join(\";\"), a, a.split(\";\")[0])",
    "onError": "set-to-blank"
  },
  {
    "op": "core/column-addition",
    "description": "Create column Val at index 1 based on column Column 1 using expression grel:value",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "Val",
    "columnInsertIndex": 1,
    "baseColumnName": "Column 1",
    "expression": "grel:value",
    "onError": "set-to-blank"
  },
  {
    "op": "core/column-move",
    "description": "Move column Val to position 0",
    "columnName": "Val",
    "index": 0
  },
  {
    "op": "core/recon",
    "description": "Reconcile cells in column Val to type Names",
    "columnName": "Val",
    "config": {
      "mode": "standard-service",
      "service": "http://0.0.0.0:5000",
      "identifierSpace": null,
      "schemaSpace": null,
      "type": {
        "id": "Names",
        "name": "Names"
      },
      "autoMatch": true,
      "columnDetails": []
    },
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    }
  },
  {
    "op": "core/column-addition",
    "description": "Create column score-lc at index 1 based on column Val using expression grel:forEach(cell.recon.candidates, v, if((v.score >= 80), v.score, '')).join(\";\")",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "score-lc",
    "columnInsertIndex": 1,
    "baseColumnName": "Val",
    "expression": "grel:forEach(cell.recon.candidates, v, if((v.score >= 80), v.score, '')).join(\";\")",
    "onError": "set-to-blank"
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column score-lc using expression grel:if(isNonBlank(value), value + \";\", value)",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "score-lc",
    "expression": "grel:if(isNonBlank(value), value + \";\", value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column score-lc using expression grel:with(split(value, \";\"), v, if(v[1]==\"\", toNumber(v[0]), max(toNumber(v[0]), toNumber(v[1]))))",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "score-lc",
    "expression": "grel:with(split(value, \";\"), v, if(v[1]==\"\", toNumber(v[0]), max(toNumber(v[0]), toNumber(v[1]))))",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/column-addition",
    "description": "Create column match-ID-F at index 1 based on column Val using expression grel:with(forEach(cell.recon.candidates, v, if(v.score == cells[\"score-lc\"].value, v.id, \"\")).join(\";\"), a, a.split(\";\")[0])",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "match-ID-F",
    "columnInsertIndex": 1,
    "baseColumnName": "Val",
    "expression": "grel:with(forEach(cell.recon.candidates, v, if(v.score == cells[\"score-lc\"].value, v.id, \"\")).join(\";\"), a, a.split(\";\")[0])",
    "onError": "set-to-blank"
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column match-ID-F using expression grel:value.replace('http://id.loc.gov/authorities/names/', '')",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "match-ID-F",
    "expression": "grel:value.replace('http://id.loc.gov/authorities/names/', '')",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  },
  {
    "op": "core/column-rename",
    "description": "Rename column Column 2 to org",
    "oldColumnName": "Column 2",
    "newColumnName": "org"
  },
  {
    "op": "core/column-addition",
    "description": "Create column match-ID at index 5 based on column LCP using expression grel:if(and(isBlank(cells[\"LCP\"].value), isNonBlank(cells[\"LCC\"].value)),cells[\"LCC\"].value,value)",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "newColumnName": "match-ID",
    "columnInsertIndex": 5,
    "baseColumnName": "LCP",
    "expression": "grel:if(and(isBlank(cells[\"LCP\"].value), isNonBlank(cells[\"LCC\"].value)),cells[\"LCC\"].value,value)",
    "onError": "set-to-blank"
  },
  {
    "op": "core/text-transform",
    "description": "Text transform on cells in column match-ID-F using expression grel:if(and(isBlank(cells[\"match-ID-F\"].value), isNonBlank(cells[\"match-ID\"].value)),cells[\"match-ID\"].value,value)",
    "engineConfig": {
      "mode": "record-based",
      "facets": []
    },
    "columnName": "match-ID-F",
    "expression": "grel:if(and(isBlank(cells[\"match-ID-F\"].value), isNonBlank(cells[\"match-ID\"].value)),cells[\"match-ID\"].value,value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10
  }
]
